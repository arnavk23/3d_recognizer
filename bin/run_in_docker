#! /bin/bash

# this port is used to connect to the docker container.
# if this port is in use, replace this number with something else.
SSH_PORT=2299

container=$(docker ps --filter "name=3d_gestures_container" -q)

if [[ "$container" != "" ]]; then
    docker kill "$container"
fi
# docker kill "3d_gestures_container"

docker run --gpus=1 --runtime=nvidia --mount type=bind,source=$PWD,destination=/3d_gestures \
    --name "3d_gestures_container" \
    --workdir=/3d_gestures \
    -p $SSH_PORT:2299 \
    --rm -d 3d_gestures bash -c "service ssh start; tail -f /dev/null"

