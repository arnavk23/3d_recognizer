#! /bin/bash

# this port is used to connect to the docker container.
# if this port is in use, replace this number with something else.
SSH_PORT=2299

container=$(docker ps --filter "name=3d_gestures_container" -q)

if [[ "$container" != "" ]]; then
    docker kill "$container"
fi
# docker kill "3d_gestures_container"

xhost +local:root > /dev/null
docker run --gpus=1 --runtime=nvidia --mount type=bind,source=$PWD,destination=/root \
    --name "3d_gestures_container" \
    -e DISPLAY=$DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix \
    -p $SSH_PORT:2299 \
    --rm -d 3d_gestures bash -c "service ssh start; tail -f /dev/null"

xhost -local:root > /dev/null

